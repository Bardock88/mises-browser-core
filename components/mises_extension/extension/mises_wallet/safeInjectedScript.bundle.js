!function(n){var i={};function r(e){var t;return(i[e]||(t=i[e]={i:e,l:!1,exports:{}},n[e].call(t.exports,t,t.exports,r),t.l=!0,t)).exports}r.m=n,r.c=i,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1655)}({1655:function(e,t,n){e.exports=n(1657)},1657:function(e,t,n){"use strict";n.r(t);var i=function(e,s,a,c){return new(a=a||Promise)(function(n,t){function i(e){try{o(c.next(e))}catch(e){t(e)}}function r(e){try{o(c.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?n(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(i,r)}o((c=c.apply(e,s||[])).next())})};const o=new class{constructor(){this.eventListener={addMessageListener:e=>window.addEventListener("message",e),removeMessageListener:e=>window.removeEventListener("message",e),postMessage:e=>window.postMessage(e,window.location.origin)}}requestMethod(e,t){var n=new Uint8Array(8);const o=Array.from(crypto.getRandomValues(n)).map(e=>e.toString(16)).join(""),s={type:"mises-proxy-request",id:o,method:e,params:t};return new Promise((t,n)=>{const i=setTimeout(()=>{t("receive response timeout")},500),r=e=>{var e=this.parseMessage?this.parseMessage(e.data):e.data;e&&"mises-safe-proxy-request-response"===e.type&&e.id===o&&(this.eventListener.removeMessageListener(r),(e=e.result)?e.error?n(new Error(e.error)):(clearTimeout(i),t(e.return)):n(new Error("Result is null")))};this.eventListener.addMessageListener(r),this.eventListener.postMessage(s)})}verifyDomain(e){return i(this,void 0,void 0,function*(){return yield this.requestMethod("verifyDomain",{domain:e})})}verifyContract(e,t){return i(this,void 0,void 0,function*(){return yield this.requestMethod("verifyContract",{contractAddress:e,domain:t})})}consoleLog(e){return this.requestMethod("consoleLog",e)}listenCurrentPage(r){return new Promise((t,n)=>{const i=e=>{var e=e.data;e&&"mises-proxy-listen-current-page"===e.type&&e.method===r&&(this.eventListener.removeMessageListener(i),(e=e.data)?t(e):n(new Error("Result is null")))};this.eventListener.addMessageListener(i)})}postUserDecision(e){var t=new Uint8Array(8),t=Array.from(crypto.getRandomValues(t)).map(e=>e.toString(16)).join("");this.eventListener.postMessage({type:"mises-proxy-listen-current-page",id:t,method:"userDecision",data:{value:e}})}listenUserDecision(){return i(this,void 0,void 0,function*(){return yield this.listenCurrentPage("userDecision")})}};var s=function(e,s,a,c){return new(a=a||Promise)(function(n,t){function i(e){try{o(c.next(e))}catch(e){t(e)}}function r(e){try{o(c.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?n(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(i,r)}o((c=c.apply(e,s||[])).next())})};const r={waitCheck:"waitCheck",pendingCheck:"pendingCheck",finshedCheck:"finshedCheck"},a={whiteDomain:"white",blackDomain:"black",fuzzyDomain:"fuzzy",normalDomain:"normal"},c="mises-safe-container";new class{constructor(){this.container=null,this.config={maxRetryNum:3,retryCount:0},this.domainInfo={domainSafeType:"",hostname:0<window.location.ancestorOrigins.length?(e=>{let t=e;var n=(t=t.match(/^[a-zA-Z0-9-]+:\/\/.+$/)?t.replace(/^[a-zA-Z0-9-]+:\/\//,""):t).indexOf("/"),n=(t=0<=n?t.slice(0,n):t).indexOf("?"),n=(t=0<=n?t.slice(0,n):t).split(".").map(e=>e.trim()).filter(e=>0<e.length);if(n.length<2)throw new Error("Invalid domain: "+e);e=n[n.length-1].indexOf(":");return 0<=e&&(n[n.length-1]=n[n.length-1].slice(0,e)),n.join(".")})(window.location.ancestorOrigins[0]):window.location.hostname,type:a.normalDomain,suggestedDomain:"",checkStatus:r.waitCheck,isShowDomainAlert:!1},this.init()}init(){this.initContainer(),this.initWeb3Proxy()}initContainer(){var e=document.getElementById(c);e?this.container=e:(this.container=document.createElement("div"),this.container.setAttribute("id",c),this.container.setAttribute("class","chrome-extension-base-class"+Math.floor(1e4*Math.random())),document.body.appendChild(this.container))}initWeb3Proxy(){const t={apply:(e,t,r)=>s(this,void 0,void 0,function*(){var t=[...r][0],n=this.isNotableAction(t).result,i=void 0!==t?t.method:"unKonwn";if(this.isShouldVerifyDomain()&&this.verifyDomain(),this.isShouldVerifyContract()&&n){let e;e="eth_signTypedData_v4"===i?(n=t.params[1],JSON.parse(n).domain.verifyingContract):t.params[0].to,o.verifyContract(e,this.domainInfo.hostname)}return e(...r)})},n=setInterval(()=>{var e;void 0!==window.ethereum?(e=new Proxy(window.ethereum.request,t),window.ethereum.request=e,clearInterval(n)):void 0!==window.web3&&(e=new Proxy(window.web3.currentProvider,t),window.web3.currentProvider=e,clearInterval(n))},1e3);setTimeout(()=>{clearInterval(n)},1e4)}isNotableAction(t){try{if(void 0!==t.method){if("eth_sendTransaction"===t.method){let e="transfer";return{result:!0,action:e=0!==t.params.length&&void 0!==t.params[0].data?e:"transfer"}}if("eth_signTypedData_v4"===t.method)return{result:!0,action:"sign"}}return{result:!1}}catch(e){return{result:!1}}}isShouldVerifyContract(){return this.domainInfo.domainSafeType!==a.whiteDomain}isShouldVerifyDomain(){return!1}verifyDomain(){return s(this,void 0,void 0,function*(){if(this.domainInfo.checkStatus===r.finshedCheck)return!0;this.domainInfo.checkStatus=r.pendingCheck;var e=yield o.verifyDomain(this.domainInfo.hostname);this.domainInfo.checkStatus=r.finshedCheck,e?(this.domainInfo.domainSafeType=e.type_string,this.domainInfo.suggestedDomain=e.origin):this.config.retryCount<this.config.maxRetryNum?(this.domainInfo.checkStatus=r.waitCheck,this.config.retryCount++):this.domainInfo.checkStatus=r.finshedCheck})}}}});