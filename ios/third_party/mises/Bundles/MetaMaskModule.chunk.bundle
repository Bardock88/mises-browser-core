(self.webpackChunkRepackMises=self.webpackChunkRepackMises||[]).push([["MetaMaskModule"],{761862:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.updatePopupState=function(e){r=e,i.AppState._emitter.emit("appStateDidChange",{app_state:i.AppState.currentState})};var i=n(803958),r=!1;i.AppState.addEventListener=function(e,t){var n=i.AppState._emitter;if(null==n)throw new Error("Cannot use AppState when `isAvailable` is false.");switch(e){case"change":var a=t;return n.addListener("appStateDidChange",(function(e){var t,n=e.app_state;a((t=n,r&&"active"===t?"active":r&&"background"!==t?t:"background"))}));case"memoryWarning":var o=t;return n.addListener("memoryWarning",o);case"blur":case"focus":var u=t;return n.addListener("appStateFocusChange",(function(t){"blur"!==e||t||u(void 0),"focus"===e&&t&&u(void 0)}))}throw new Error("Trying to subscribe to unknown event: "+e)}},945235:function(e,t,n){var i=n(564836);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(627424)),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=r?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(i,a,o):i[a]=e[a]}i.default=e,n&&n.set(e,i);return i}(n(735466)),o=i(n(45697)),u=n(803958),s=i(n(749925)),c=i(n(26722)),d=n(133823);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}var f=u.StyleSheet.create({loaderContainer:{position:"absolute",zIndex:999,width:"100%",height:"100%"}});function g(e){var t=e.uri,n=e.style,i=e.onClose,o=e.textTracks,l=e.selectedTextTrack,g=(0,a.useState)(!0),p=(0,r.default)(g,2),v=p[0],h=p[1],b=(0,a.useState)(!1),w=(0,r.default)(b,2),y=w[0],k=w[1];var M,m=Number.isInteger(t)?t:"string"==typeof(M=t)||M instanceof String?{uri:t}:t;return(0,d.jsxs)(u.View,{style:n,children:[v&&(0,d.jsx)(u.View,{style:[f.loaderContainer,n],children:(0,d.jsx)(c.default,{error:y,onClose:i})}),(0,d.jsx)(s.default,{onLoad:function(){return h(!1)},onError:function(){return k(!0)},style:n,muted:!0,source:m,controls:!0,textTracks:o,selectedTextTrack:l,ignoreSilentSwitch:"ignore"})]})}g.propTypes={uri:o.default.oneOfType([o.default.string,o.default.number,o.default.object]),style:u.ViewPropTypes.style,onClose:o.default.func,textTracks:o.default.arrayOf(o.default.object),selectedTextTrack:o.default.object},g.defaultProps={onError:function(){return null}};var p=g;t.default=p},600757:function(e,t,n){e.exports={get AsyncStorage(){return n(569111).default}}},362093:function(e,t,n){var i=n(564836);Object.defineProperty(t,"__esModule",{value:!0}),t.BridgeManager=void 0;var r=i(n(600861)),a=i(n(856690)),o=i(n(689728)),u=i(n(238416)),s=function(){function e(){var t=this;(0,a.default)(this,e),(0,u.default)(this,"processPendingMessages",(function(e){!t.blocking&&t.pendingMessages.length&&((0,r.default)(t.pendingMessages).forEach((function(t){e(t.data,t.webviewid)})),t.pendingMessages=[])})),this.backgroundBridges=[],this.pendingMessages=[],this.ready=!1,this.windowVisible=!1,this.blocking=!1}return(0,o.default)(e,[{key:"onReady",value:function(){this.ready=!0}},{key:"onBlock",value:function(e){this.blocking=e}},{key:"activateBridge",value:function(e,t,n){if(!this.ready||this.blocking)return this.pendingMessages=[{webviewid:e.webviewid,data:t}].concat((0,r.default)(this.pendingMessages)),null;var i=this.findBridge(e);i||(this.clearIdleBridge(),i=n(e)),i&&i.onMessage(t)}},{key:"sendNotification",value:function(e,t){this.clearIdleBridge(),(0,r.default)(this.backgroundBridges).forEach((function(n){var i=new URL(n.info().origin).hostname;t[i]&&n.onNotification(e)}))}},{key:"findBridge",value:function(e){var t=e.origin,n=e.webviewid;return t&&n&&(0,r.default)(this.backgroundBridges).find((function(e){return e.info().webviewid===n&&e.info().origin===t}))||null}},{key:"clearIdleBridge",value:function(){var e=(0,r.default)(this.backgroundBridges),t=(new Date).getTime();this.backgroundBridges=e.filter((function(e){if(!e)return!1;var n=e.lastActiveTime();return!(!n||t-n>36e5)||(e.disconnect(),!1)}))}},{key:"clear",value:function(){var e=(0,r.default)(this.backgroundBridges);this.backgroundBridges=e.filter((function(e){return!!e&&(e.disconnect(),!1)})),this.pendingMessages=[]}}]),e}();t.BridgeManager=s},402305:function(e,t,n){var i=n(564836);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=r?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(i,a,o):i[a]=e[a]}i.default=e,n&&n.set(e,i);return i}(n(735466));n(29311),n(99549),n(99549),n(595141),n(277834),n(495580);var a=n(803958);n(761862);var o=n(383986),u=i(n(472539)),s=i(n(801600)),c=n(133823);function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}var l=function(){var e=a.StyleSheet.create({main:Object.assign({},a.StyleSheet.absoluteFillObject)});return(0,r.useEffect)((function(){var e=!1,t=o.store.subscribe((function(){if(!e){var n=o.store.getState();0!==Object.keys(n.engine.backgroundState).length&&(e=!0,a.InteractionManager.runAfterInteractions((function(){t(),s.default.onEngineReady()})))}}));s.default.init()}),[]),(0,c.jsx)(a.View,{style:e.main,children:(0,c.jsx)(u.default,{})})};t.default=l},801600:function(e,t,n){var i=n(564836);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a=i(n(366115)),o=i(n(238416)),u=i(n(856690)),s=i(n(689728)),c=i(n(861655)),d=i(n(994993)),l=i(n(73808)),f=i(n(917156)),g=i(n(445806)),p=n(803958),v=i(n(296505)),h=i(n(309874)),b=n(362093),w=n(761862);function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.default)(e);if(t){var r=(0,l.default)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,d.default)(this,n)}}var k=n(717187).EventEmitter,M=p.NativeModules.MisesModule,m={},P=function(){return m},S=function(e){m=e},C=function(e){m[e]=!0},B=function(){return!1},_={current:!1},A={current:!1},j=function(){return null},O=function(){return(r=r||(0,f.default)((function*(){}))).apply(this,arguments)},T={},E=function(e){(0,c.default)(n,e);var t=y(n);function n(e){var i;return(0,u.default)(this,n),(i=t.call(this)).bridgeInfo=e,i.activeTime=(new Date).getTime(),i.bacgroundBridge=new g.default({webview:{current:e.webviewid},url:e.origin,getRpcMethodMiddleware:function(t){var n=t.hostname,i=t.getProviderState;return(0,h.default)({hostname:n,getProviderState:i,navigation:null,getApprovedHosts:P,setApprovedHosts:S,approveHost:C,url:{current:e.origin},title:{current:""},icon:{current:""},isHomepage:B,fromHomepage:_,toggleUrlModal:j,wizardScrollAdjusted:A,tabId:0,injectHomePageScripts:O,isWalletConnect:false,isMMSDK:true,analytics:T})},isMainFrame:!0,isRemoteConn:true,sendMessage:function(t){t.data&&t.data.error&&t.data.error.data&&t.data.error.data.originalError&&4902===t.data.error.data.originalError.code&&(t.data.error.code=t.data.error.data.originalError.code),M.postMessageFromMetamask(JSON.stringify(t),"*",e.webviewid)}}),i}return(0,s.default)(n,[{key:"info",value:function(){return this.bridgeInfo}},{key:"onMessage",value:function(e){e&&e.method&&"metamask_getProviderState"!==e.method&&(this.activeTime=(new Date).getTime()),this.bacgroundBridge.onMessage(e)}},{key:"onNotification",value:function(e){this.bacgroundBridge.sendNotification(e)}},{key:"lastActiveTime",value:function(){return this.activeTime}},{key:"disconnect",value:function(){this.bacgroundBridge.onDisconnect()}}]),n}(k),x=function(e,t){(0,c.default)(i,e);var n=y(i);function i(){var e;return(0,u.default)(this,i),e=n.call(this),(0,o.default)((0,a.default)(e),"prefListener",(function(t){t.selectedAddress&&e.emit("unlock")})),(0,o.default)((0,a.default)(e),"handleAppStateChange",(function(t){e.emit("appstate_change",t)})),(0,o.default)((0,a.default)(e),"handlePendingApprovals",(function(t){0===e.lastPendingApprovalCount&&t.pendingApprovalCount>0&&!e.windowVisible&&(e.popupByBridge=!0,M.popup("metamask")),e.lastPendingApprovalCount>0&&0===t.pendingApprovalCount&&e.windowVisible&&(e.popupByBridge&&M.dismiss("metamask"),e.popupByBridge=!1),e.lastPendingApprovalCount=t.pendingApprovalCount})),(0,o.default)((0,a.default)(e),"postMessageFromWeb",(function(t,n){try{var i="string"==typeof t?JSON.parse(t):t;if(!i||!i.name)return;if(i.name){var r=(i&&i.origin&&new URL(i.origin)).origin,a="";if(i&&i.data&&i.data.method){a=i.data.method;["eth_requestAccounts","wallet_addEthereumChain","wallet_switchEthereumChain","eth_sendTransaction","eth_sign","personal_sign","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4"].includes(a)&&e.ensureUnlock()}return void e.bridgeManager.activateBridge({origin:r,webviewid:n},i,(function(e){return new E(e)}))}}catch(e){}})),e.bridgeManager=new b.BridgeManager,e.windowVisible=!1,e.popupByBridge=!1,e.lastPendingApprovalCount=0,(0,w.updatePopupState)(e.windowVisible),e}return(0,s.default)(i,[{key:"ensureUnlock",value:function(){return(t=t||(0,f.default)((function*(){if(!v.default.context.KeyringController.isUnlocked()){this.bridgeManager.onBlock(!0),this.popupByBridge=!0,this.lastPendingApprovalCount=0,M.popup("metamask");var e=this,t=new Promise((function(t,n){function i(){e.removeListener("unlock",a),e.removeListener("window_hide",r)}function r(){i(),n("dismissed")}function a(){i(),t("unlocked")}e.once("unlock",a),e.once("window_hide",r)}));try{yield t}catch(e){}this.bridgeManager.onBlock(!1),this.scheduleCheckPending()}}))).apply(this,arguments)}},{key:"onEngineReady",value:function(){v.default.context.PreferencesController.subscribe(this.prefListener),this.bridgeManager.onReady(),this.scheduleCheckPending(),p.AppState.addEventListener("change",this.handleAppStateChange),v.default.controllerMessenger.subscribe("ApprovalController:stateChange",this.handlePendingApprovals)}},{key:"scheduleCheckPending",value:function(){var e=this;setTimeout((function(){p.InteractionManager.runAfterInteractions((function(){e.bridgeManager.processPendingMessages(e.postMessageFromWeb)}))}),1e3)}},{key:"clear",value:function(){this.bridgeManager.clear(),v.default.controllerMessenger.unsubscribe("ApprovalController:stateChange",this.handlePendingApprovals)}},{key:"sendNotification",value:function(e){this.bridgeManager.sendNotification(e,m)}},{key:"windowStatusChanged",value:function(e){e&&"show"===e?(this.windowVisible=!0,this.emit("window_show")):e&&"hide"===e&&(this.windowVisible=!1,this.emit("window_hide")),(0,w.updatePopupState)(this.windowVisible)}},{key:"isWindowVisible",value:function(){return this.windowVisible}}]),i}(k),R=new x,V={init:function(){var e=n(345507),t=e.getCallableModule("NativeBridge");if(t&&t.pendingMessages)for(var i of t.pendingMessages)R.postMessageFromWeb(i.data,i.webviewid);e.registerCallableModule("NativeBridge",{postMessage:function(e,t){R.postMessageFromWeb(e,t)},windowStatusChanged:function(e){R.windowStatusChanged(e)}}),M.ready("metamask")},sendNotification:function(e){R.sendNotification(e)},onEngineReady:function(){R.onEngineReady()},isWindowVisible:function(){return R.isWindowVisible()},clear:function(){return R.clear()}};t.default=V},735883:function(){},336563:function(){},446601:function(){},989214:function(){},271922:function(){},702363:function(){},127790:function(){},646314:function(){},173327:function(){},431216:function(){},225973:function(){},420664:function(){},557130:function(){},214799:function(){},536589:function(){},107743:function(){},831530:function(){},301521:function(){},426337:function(){},740975:function(){},151403:function(){},685600:function(){},578529:function(){},28171:function(){},365243:function(){},752361:function(){},394616:function(){},206567:function(){},140964:function(){},337597:function(){}}]);//# sourceMappingURL=MetaMaskModule.chunk.bundle.map?platform=ios