(self.webpackChunkRepackMises=self.webpackChunkRepackMises||[]).push([["MisesWalletModule"],{761862:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.updatePopupState=function(e){a=e,i.AppState._emitter.emit("appStateDidChange",{app_state:i.AppState.currentState})};var i=t(803958),a=!1;i.AppState.addEventListener=function(e,n){var t=i.AppState._emitter;if(null==t)throw new Error("Cannot use AppState when `isAvailable` is false.");switch(e){case"change":var r=n;return t.addListener("appStateDidChange",(function(e){var n,t=e.app_state;r((n=t,a&&"active"===n?"active":a&&"background"!==n?n:"background"))}));case"memoryWarning":var s=n;return t.addListener("memoryWarning",s);case"blur":case"focus":var o=n;return t.addListener("appStateFocusChange",(function(n){"blur"!==e||n||o(void 0),"focus"===e&&n&&o(void 0)}))}throw new Error("Trying to subscribe to unknown event: "+e)}},600757:function(e,n,t){e.exports={get AsyncStorage(){return t(569111).default}}},642001:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=t(803958).NativeModules.MisesModule,a={setToMisesPrivate:function(e){return i.setMisesUserInfo(JSON.stringify(e)),Promise.resolve()},getinstallreferrer:function(){return new Promise((function(e){e(i.getInstallReferrer())}))}};n.default=a},362093:function(e,n,t){var i=t(564836);Object.defineProperty(n,"__esModule",{value:!0}),n.BridgeManager=void 0;var a=i(t(600861)),r=i(t(856690)),s=i(t(689728)),o=i(t(238416)),u=function(){function e(){var n=this;(0,r.default)(this,e),(0,o.default)(this,"processPendingMessages",(function(e){!n.blocking&&n.pendingMessages.length&&((0,a.default)(n.pendingMessages).forEach((function(n){e(n.data,n.webviewid)})),n.pendingMessages=[])})),this.backgroundBridges=[],this.pendingMessages=[],this.ready=!1,this.windowVisible=!1,this.blocking=!1}return(0,s.default)(e,[{key:"onReady",value:function(){this.ready=!0}},{key:"onBlock",value:function(e){this.blocking=e}},{key:"activateBridge",value:function(e,n,t){if(!this.ready||this.blocking)return this.pendingMessages=[{webviewid:e.webviewid,data:n}].concat((0,a.default)(this.pendingMessages)),null;var i=this.findBridge(e);i||(this.clearIdleBridge(),i=t(e)),i&&i.onMessage(n)}},{key:"sendNotification",value:function(e,n){this.clearIdleBridge(),(0,a.default)(this.backgroundBridges).forEach((function(t){var i=new URL(t.info().origin).hostname;n[i]&&t.onNotification(e)}))}},{key:"findBridge",value:function(e){var n=e.origin,t=e.webviewid;return n&&t&&(0,a.default)(this.backgroundBridges).find((function(e){return e.info().webviewid===t&&e.info().origin===n}))||null}},{key:"clearIdleBridge",value:function(){var e=(0,a.default)(this.backgroundBridges),n=(new Date).getTime();this.backgroundBridges=e.filter((function(e){if(!e)return!1;var t=e.lastActiveTime();return!(!t||n-t>36e5)||(e.disconnect(),!1)}))}},{key:"clear",value:function(){var e=(0,a.default)(this.backgroundBridges);this.backgroundBridges=e.filter((function(e){return!!e&&(e.disconnect(),!1)})),this.pendingMessages=[]}}]),e}();n.BridgeManager=u},953210:function(e,n,t){var i=t(564836);Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;i(t(735466));t(142140),t(595141),t(14589),t(948731),t(277834),t(495580),t(911546);var a=t(803958);t(761862);var r=t(402188),s=i(t(874800)),o=t(133823),u=function(){var e=a.StyleSheet.create({main:Object.assign({},a.StyleSheet.absoluteFillObject)});return s.default.init(),(0,o.jsx)(a.View,{style:e.main,children:(0,o.jsx)(r.App,{})})};n.default=u},874800:function(e,n,t){var i=t(564836);Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=i(t(917156)),r=i(t(238416)),s=i(t(856690)),o=i(t(689728)),u=i(t(366115)),c=i(t(861655)),d=i(t(994993)),l=i(t(73808)),f=t(803958),g=t(362093),p=t(860242),v=t(570492),h=t(484497),w=t(630158),b=t(513011),k=t(761862);function y(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,i=(0,l.default)(e);if(n){var a=(0,l.default)(this).constructor;t=Reflect.construct(i,arguments,a)}else t=i.apply(this,arguments);return(0,d.default)(this,t)}}var M=t(717187).EventEmitter,m=f.NativeModules.MisesModule,S=function(e){(0,c.default)(t,e);var n=y(t);function t(e,i){var a;(0,s.default)(this,t),(a=n.call(this)).bridgeInfo=e,a.activeTime=(new Date).getTime(),a.keplr=new v.Keplr("0.10.10","core",new p.RNMessageRequesterExternal((function(){return{url:e.origin,origin:e.origin}})));var r=(0,u.default)(a);return h.RNInjectedKeplr.startProxy(a.keplr,{addMessageListener:function(e){r.addListener("message",e)},postMessage:function(n){i(n,e.webviewid)}},h.RNInjectedKeplr.parseWebviewMessage),a}return(0,o.default)(t,[{key:"info",value:function(){return this.bridgeInfo}},{key:"onMessage",value:function(e){this.activeTime=(new Date).getTime(),this.emit("message",{data:e})}},{key:"onNotification",value:function(e){}},{key:"lastActiveTime",value:function(){return this.activeTime}},{key:"disconnect",value:function(){}}]),t}(M),R=function(e,n,t){(0,c.default)(d,e);var i=y(d);function d(){var e;return(0,s.default)(this,d),e=i.call(this),(0,r.default)((0,u.default)(e),"methodsRequireUnlock",["connect","enable","signAmino","signDirect","signArbitrary","signEthereum"]),(0,r.default)((0,u.default)(e),"postMessageFromWeb",(function(n,t){try{var i="string"==typeof n?JSON.parse(n):n;if(!i||!i.id)return;if(i.method){var a=(i.origin&&new URL(i.origin)).origin,r=i.method;return e.methodsRequireUnlock.includes(r)&&(e.ensureUnlock(),e.pendingPopupMessageID=i.id),void e.bridgeManager.activateBridge({origin:a,webviewid:t},i,(function(n){return new S(n,e.postMessageToWeb)}))}}catch(e){}})),(0,r.default)((0,u.default)(e),"postMessageToWeb",(function(n,t){e.pendingPopupMessageID===n.id&&e.isWindowVisible()&&(e.pendingPopupMessageID="",m.dismiss("mises-wallet")),m.postMessageFromMisesWallet(JSON.stringify(n),"*",t)})),(0,r.default)((0,u.default)(e),"handleAppStateChange",(function(n){e.emit("appstate_change",n)})),e.bridgeManager=new g.BridgeManager,e.windowVisible=!1,e.locked=!0,e.pendingPopupMessageID="",(0,k.updatePopupState)(e.windowVisible),e}return(0,o.default)(d,[{key:"onEngineReady",value:function(){this.bridgeManager.onReady(),this.scheduleCheckPending(),f.AppState.addEventListener("change",this.handleAppStateChange)}},{key:"scheduleCheckPending",value:function(){var e=this;setTimeout((function(){f.InteractionManager.runAfterInteractions((function(){e.bridgeManager.processPendingMessages(e.postMessageFromWeb)}))}),1e3)}},{key:"updateUnlockStatus",value:function(){return(n=n||(0,a.default)((function*(){var e=new p.RNMessageRequesterExternal((function(){return{url:"react-native://internal",origin:"react-native://internal"}}));(yield e.sendMessage(w.BACKGROUND_PORT,new b.IsUnlockMsg))?this.updateKeyringStatus("unlock"):this.updateKeyringStatus("lock")}))).apply(this,arguments)}},{key:"updateKeyringStatus",value:function(e){this.locked="unlock"!==e,this.emit(e)}},{key:"ensureUnlock",value:function(){return(t=t||(0,a.default)((function*(){var e=this;if(this.locked){this.bridgeManager.onBlock(!0),m.popup("mises-wallet");var n=this,t=setInterval((function(){return e.updateUnlockStatus()}),1e3),i=new Promise((function(e,t){function i(){n.removeListener("unlock",r),n.removeListener("window_hide",a)}function a(){i(),t("dismissed")}function r(){i(),e("unlocked")}n.once("unlock",r),n.once("window_hide",a)}));try{yield i}catch(e){}this.bridgeManager.onBlock(!1),clearInterval(t),yield this.updateUnlockStatus(),this.scheduleCheckPending()}}))).apply(this,arguments)}},{key:"windowStatusChanged",value:function(e){e&&"show"===e?(this.windowVisible=!0,this.emit("window_show")):e&&"hide"===e&&(this.windowVisible=!1,this.emit("window_hide")),(0,k.updatePopupState)(this.windowVisible)}},{key:"isWindowVisible",value:function(){return this.windowVisible}},{key:"sendNotification",value:function(e){}},{key:"clear",value:function(){this.bridgeManager.clear()}}]),d}(M),_=new R,B={init:function(){var e=t(345507),n=e.getCallableModule("NativeBridge");if(n&&n.pendingMessages)for(var i of n.pendingMessages)_.postMessageFromWeb(i.data,i.webviewid);e.registerCallableModule("NativeBridge",{postMessage:function(e,n){_.postMessageFromWeb(e,n)},windowStatusChanged:function(e){_.windowStatusChanged(e)}}),m.ready("mises-wallet"),this.onEngineReady()},sendNotification:function(e){_.sendNotification(e)},onEngineReady:function(){_.onEngineReady()},isWindowVisible:function(){return _.isWindowVisible()},updateKeyringStatus:function(e){_.updateKeyringStatus(e)},clear:function(){return _.clear()}};n.default=B},669780:function(e,n,t){var i=t(242635);e.exports=Object.assign({},i,{constants:{Z_SYNC_FLUSH:i.Z_SYNC_FLUSH,BROTLI_OPERATION_FLUSH:i.BROTLI_OPERATION_FLUSH}})},137076:function(){},589180:function(){},88677:function(){},985811:function(){},69159:function(){},463018:function(){},336563:function(){},446601:function(){},989214:function(){},271922:function(){},702363:function(){},507716:function(){},453383:function(){},842480:function(){},206297:function(){},870131:function(){},194093:function(){},761695:function(){},875992:function(){},878110:function(){},752361:function(){},394616:function(){},283954:function(){},140964:function(){},337597:function(){},255896:function(){},187500:function(){}}]);//# sourceMappingURL=MisesWalletModule.chunk.bundle.map?platform=ios